<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body {
        margin: 0;
        padding: 0;
        overflow: hidden; /* Para ocultar barras de desplazamiento */
    }

    #player-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: black; /* Fondo negro para el reproductor */
    }
    #loading-message {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: red;
        font-size: 34px;
        z-index: 9999; /* Asegurar que el mensaje esté encima de todo */
    }
    #player {
        width: 100% !important;
        height: 100% !important;
    }
</style>
<script src="jwplayer.js"></script>
<script> 
  // default options
  ConsoleBan.init();
  // custom options
  ConsoleBan.init({
    redirect: '/'
  });
</script>
<script> 
    jwplayer.key = 'XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo';
</script>
</head>
<body>
<script type="text/javascript">
function getParameterByName(name) {
    name = name.replace(/[\[]/, "\[").replace(/[\]]/, "\]");
    var regex = new RegExp("[\?&]" + name + "=([^&#]*)"),
    results = regex.exec(location.search);
    return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}

let Source = getParameterByName('s');
let key = getParameterByName('key');
let keyId = getParameterByName('kid');
let getLang = getParameterByName('lang');
if (Source == "#") {alert('Vuelve a la página anterior');}
</script>
<div id="player-container">
    <div id="loading-message">xxxxx<br> </div>
    <div id="player"> <!-- Agregamos el mensaje de carga aquí -->
</div>
</div>
<script>
// Función para activar el modo de pantalla completa
function toggleFullscreen() {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
    } else {
        if (document.exitFullscreen) {
            document.exitFullscreen();
        }
    }
}

// Llamamos a la función toggleFullscreen al hacer clic en el reproductor de video
document.getElementById("player").addEventListener("click", function() {
    toggleFullscreen();
});

// Simulamos la pulsación de la tecla F11 para activar automáticamente el modo de pantalla completa
window.addEventListener("load", function() {
    document.body.addEventListener("keydown", function(e) {
        if (e.key === "F11") {
            toggleFullscreen();
        }
    });
});

var playerInstance = jwplayer("player");

playerInstance.setup({
    playlist: [{
        "sources": [{
            "default": false,
            "title": "Personaltv",
            "type": "dash",
            "file": Source,
            "drm": {
                "clearkey": { "keyId": keyId, "key": key }
            },
            "label": "0"
        }]
    }],
    width: "100%",
    height: "100%",
    aspectratio: "16:9",
    autostart: true,
    cast: {},
    sharing: {},
    controls: true,
    displaytitle: true,
    label: "720p",
    defaultQuality: "720"
}); 

var bufferComplete = false;
var videoComplete = false;

playerInstance.on("buffer", function () {
    bufferComplete = true;
    checkLoadingState();
});

playerInstance.on("complete", function () {
    videoComplete = true;
    checkLoadingState();
});

function checkLoadingState() {
    if (bufferComplete && videoComplete) {
        document.getElementById('loading-message').style.display = 'none';
    }
}

// Verificar el estado del búfer periódicamente
var bufferCheckInterval = setInterval(function() {
    var bufferPercentage = playerInstance.getBuffer();
    if (bufferPercentage >= 95) { // Por ejemplo, ocultar el mensaje de carga cuando el búfer sea del 95% o más
        clearInterval(bufferCheckInterval); // Detener la verificación del búfer
        document.getElementById('loading-message').style.display = 'none';
    }
}, 1000); // Verificar cada segundo (1000 milisegundos)
</script>

<script>
    // Verificar el estado del búfer periódicamente
var bufferCheckInterval = setInterval(function() {
    var bufferPercentage = playerInstance.getBuffer();
    if (bufferPercentage >= 95) { // Por ejemplo, ocultar el mensaje de carga cuando el búfer sea del 95% o más
        clearInterval(bufferCheckInterval); // Detener la verificación del búfer
        document.getElementById('loading-message').style.display = 'none';
    }
}, 1000); // Verificar cada segundo (1000 milisegundos)
</script>
</body>
</html>
